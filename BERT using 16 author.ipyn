{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"BERT using 16 author.ipyn","provenance":[{"file_id":"1R_sQ5D1I3JXwtEnuBCk4xwPNcT3KkyHs","timestamp":1602193755787},{"file_id":"1YFMLrR3oZRuSvZDdkWbkAwSGcG454t_2","timestamp":1602187814832},{"file_id":"1RCjoJ9RkZnrABq5Ol8yptD0paJeZ4hE7","timestamp":1602187360847}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"ede2cdee80b14e47a2f3c2db215ecfd5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1c6037682b884c88a0a2a3be518409db","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b0bcdd3057f24fe985a8e4389b82e561","IPY_MODEL_1b1efae2b76f4ae3a59c1b9f0667e9aa"]}},"1c6037682b884c88a0a2a3be518409db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b0bcdd3057f24fe985a8e4389b82e561":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_879fd15d70244513a4e3d6c00dce311a","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":466,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":466,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_26a3155997364fc6afec7c31c6368b34"}},"1b1efae2b76f4ae3a59c1b9f0667e9aa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_17bda29b523b4a31956dec37f5fa8676","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 466/466 [00:01&lt;00:00, 265B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e9da21340d0445d581bc6c8b857423be"}},"879fd15d70244513a4e3d6c00dce311a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"26a3155997364fc6afec7c31c6368b34":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"17bda29b523b4a31956dec37f5fa8676":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e9da21340d0445d581bc6c8b857423be":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a65b4c54df514a4984b0666fe7073281":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1d478e6c21c24ea7bfb4cfd1cb117dfb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_821936bd7f8f4bd4945f0fdab5c24336","IPY_MODEL_c43c90cb22534b22ab86f0941d80adda"]}},"1d478e6c21c24ea7bfb4cfd1cb117dfb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"821936bd7f8f4bd4945f0fdab5c24336":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1b1fec41cff04635ac9992f9557badf6","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":995526,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":995526,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_70a37fadfbd9482cad8cdc2905c99503"}},"c43c90cb22534b22ab86f0941d80adda":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_15cc16cbfd864f72945ef2f5e4f9266a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 996k/996k [00:00&lt;00:00, 2.05MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_91a19896d3b2425f92e21072a50b04d6"}},"1b1fec41cff04635ac9992f9557badf6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"70a37fadfbd9482cad8cdc2905c99503":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"15cc16cbfd864f72945ef2f5e4f9266a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"91a19896d3b2425f92e21072a50b04d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d22de94c6b4e4882907f1f6bc39b6554":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8c98be5b185b4bdbbd4276863f3614e7","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b2d8c69b90eb4e4e81f7411b6aa4516d","IPY_MODEL_50c8d470087c405a8671178e2999538b"]}},"8c98be5b185b4bdbbd4276863f3614e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b2d8c69b90eb4e4e81f7411b6aa4516d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e7803ec4431b4f5e98ac139e71c6e611","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":910749124,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":910749124,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b3d02cff1332439f85ebc275cab6dd2e"}},"50c8d470087c405a8671178e2999538b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_98345303d8c54a24af0bceda3ffb14bf","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 911M/911M [00:30&lt;00:00, 30.1MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8d45290336d14327821bfa217cd6aa35"}},"e7803ec4431b4f5e98ac139e71c6e611":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b3d02cff1332439f85ebc275cab6dd2e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"98345303d8c54a24af0bceda3ffb14bf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8d45290336d14327821bfa217cd6aa35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"q9aRI2Xll0MZ","executionInfo":{"status":"ok","timestamp":1602193866425,"user_tz":-360,"elapsed":31342,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"10037a73-9a88-4265-adf0-d15b8cb1b912","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["from google.colab import drive\n","drive.mount(\"/content/drive\")"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Mounted at /content/drive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"HmVXPNlMQNNH","executionInfo":{"status":"ok","timestamp":1602193895039,"user_tz":-360,"elapsed":31870,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"a93297e4-92c3-493f-a1f2-51e1e0deaafd","colab":{"base_uri":"https://localhost:8080/","height":1000}},"source":["!pip3 install ktrain"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Collecting ktrain\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/79/11/168a692027a2be036676d8ba24f0b7b9dfb18a9deb3daf10e6a0cfd2917d/ktrain-0.22.1.tar.gz (25.2MB)\n","\u001b[K     |████████████████████████████████| 25.3MB 128kB/s \n","\u001b[?25hRequirement already satisfied: scikit-learn>=0.21.3 in /usr/local/lib/python3.6/dist-packages (from ktrain) (0.22.2.post1)\n","Requirement already satisfied: matplotlib>=3.0.0 in /usr/local/lib/python3.6/dist-packages (from ktrain) (3.2.2)\n","Requirement already satisfied: pandas>=1.0.1 in /usr/local/lib/python3.6/dist-packages (from ktrain) (1.1.2)\n","Requirement already satisfied: fastprogress>=0.1.21 in /usr/local/lib/python3.6/dist-packages (from ktrain) (1.0.0)\n","Collecting keras_bert>=0.86.0\n","  Downloading https://files.pythonhosted.org/packages/e2/7f/95fabd29f4502924fa3f09ff6538c5a7d290dfef2c2fe076d3d1a16e08f0/keras-bert-0.86.0.tar.gz\n","Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from ktrain) (2.23.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.6/dist-packages (from ktrain) (0.16.0)\n","Collecting langdetect\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/56/a3/8407c1e62d5980188b4acc45ef3d94b933d14a2ebc9ef3505f22cf772570/langdetect-1.0.8.tar.gz (981kB)\n","\u001b[K     |████████████████████████████████| 983kB 43.7MB/s \n","\u001b[?25hRequirement already satisfied: jieba in /usr/local/lib/python3.6/dist-packages (from ktrain) (0.42.1)\n","Collecting cchardet\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/1e/c5/7e1a0d7b4afd83d6f8de794fce82820ec4c5136c6d52e14000822681a842/cchardet-2.1.6-cp36-cp36m-manylinux2010_x86_64.whl (241kB)\n","\u001b[K     |████████████████████████████████| 245kB 49.1MB/s \n","\u001b[?25hRequirement already satisfied: networkx>=2.3 in /usr/local/lib/python3.6/dist-packages (from ktrain) (2.5)\n","Requirement already satisfied: bokeh in /usr/local/lib/python3.6/dist-packages (from ktrain) (2.1.1)\n","Collecting seqeval\n","  Downloading https://files.pythonhosted.org/packages/93/e5/b7705156a77f742cfe4fc6f22d0c71591edb2d243328dff2f8fc0f933ab6/seqeval-0.0.19.tar.gz\n","Requirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from ktrain) (20.4)\n","Collecting transformers>=3.1.0\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/19/22/aff234f4a841f8999e68a7a94bdd4b60b4cebcfeca5d67d61cd08c9179de/transformers-3.3.1-py3-none-any.whl (1.1MB)\n","\u001b[K     |████████████████████████████████| 1.1MB 50.0MB/s \n","\u001b[?25hRequirement already satisfied: ipython in /usr/local/lib/python3.6/dist-packages (from ktrain) (5.5.0)\n","Collecting syntok\n","  Downloading https://files.pythonhosted.org/packages/8c/76/a49e73a04b3e3a14ce232e8e28a1587f8108baa665644fe8c40e307e792e/syntok-1.3.1.tar.gz\n","Collecting whoosh\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ba/19/24d0f1f454a2c1eb689ca28d2f178db81e5024f42d82729a4ff6771155cf/Whoosh-2.7.4-py2.py3-none-any.whl (468kB)\n","\u001b[K     |████████████████████████████████| 471kB 49.0MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.11.0 in /usr/local/lib/python3.6/dist-packages (from scikit-learn>=0.21.3->ktrain) (1.18.5)\n","Requirement already satisfied: scipy>=0.17.0 in /usr/local/lib/python3.6/dist-packages (from scikit-learn>=0.21.3->ktrain) (1.4.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.0.0->ktrain) (1.2.0)\n","Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.0.0->ktrain) (2.4.7)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.0.0->ktrain) (0.10.0)\n","Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.0.0->ktrain) (2.8.1)\n","Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas>=1.0.1->ktrain) (2018.9)\n","Requirement already satisfied: Keras>=2.4.3 in /usr/local/lib/python3.6/dist-packages (from keras_bert>=0.86.0->ktrain) (2.4.3)\n","Collecting keras-transformer>=0.38.0\n","  Downloading https://files.pythonhosted.org/packages/89/6c/d6f0c164f4cc16fbc0d0fea85f5526e87a7d2df7b077809e422a7e626150/keras-transformer-0.38.0.tar.gz\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests->ktrain) (2020.6.20)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->ktrain) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->ktrain) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests->ktrain) (1.24.3)\n","Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from langdetect->ktrain) (1.15.0)\n","Requirement already satisfied: decorator>=4.3.0 in /usr/local/lib/python3.6/dist-packages (from networkx>=2.3->ktrain) (4.4.2)\n","Requirement already satisfied: typing-extensions>=3.7.4 in /usr/local/lib/python3.6/dist-packages (from bokeh->ktrain) (3.7.4.3)\n","Requirement already satisfied: PyYAML>=3.10 in /usr/local/lib/python3.6/dist-packages (from bokeh->ktrain) (3.13)\n","Requirement already satisfied: Jinja2>=2.7 in /usr/local/lib/python3.6/dist-packages (from bokeh->ktrain) (2.11.2)\n","Requirement already satisfied: tornado>=5.1 in /usr/local/lib/python3.6/dist-packages (from bokeh->ktrain) (5.1.1)\n","Requirement already satisfied: pillow>=4.0 in /usr/local/lib/python3.6/dist-packages (from bokeh->ktrain) (7.0.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.6/dist-packages (from transformers>=3.1.0->ktrain) (4.41.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.6/dist-packages (from transformers>=3.1.0->ktrain) (3.0.12)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.6/dist-packages (from transformers>=3.1.0->ktrain) (2019.12.20)\n","Requirement already satisfied: dataclasses; python_version < \"3.7\" in /usr/local/lib/python3.6/dist-packages (from transformers>=3.1.0->ktrain) (0.7)\n","Collecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/34/09d19aff26edcc8eb2a01bed8e98f13a1537005d31e95233fd48216eed10/sacremoses-0.0.43.tar.gz (883kB)\n","\u001b[K     |████████████████████████████████| 890kB 39.9MB/s \n","\u001b[?25hCollecting sentencepiece!=0.1.92\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d4/a4/d0a884c4300004a78cca907a6ff9a5e9fe4f090f5d95ab341c53d28cbc58/sentencepiece-0.1.91-cp36-cp36m-manylinux1_x86_64.whl (1.1MB)\n","\u001b[K     |████████████████████████████████| 1.1MB 41.2MB/s \n","\u001b[?25hCollecting tokenizers==0.8.1.rc2\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/80/83/8b9fccb9e48eeb575ee19179e2bdde0ee9a1904f97de5f02d19016b8804f/tokenizers-0.8.1rc2-cp36-cp36m-manylinux1_x86_64.whl (3.0MB)\n","\u001b[K     |████████████████████████████████| 3.0MB 41.0MB/s \n","\u001b[?25hRequirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (4.3.3)\n","Requirement already satisfied: pexpect; sys_platform != \"win32\" in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (4.8.0)\n","Requirement already satisfied: simplegeneric>0.8 in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (0.8.1)\n","Requirement already satisfied: setuptools>=18.5 in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (50.3.0)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (2.6.1)\n","Requirement already satisfied: prompt-toolkit<2.0.0,>=1.0.4 in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (1.0.18)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.6/dist-packages (from ipython->ktrain) (0.7.5)\n","Requirement already satisfied: h5py in /usr/local/lib/python3.6/dist-packages (from Keras>=2.4.3->keras_bert>=0.86.0->ktrain) (2.10.0)\n","Collecting keras-pos-embd>=0.11.0\n","  Downloading https://files.pythonhosted.org/packages/09/70/b63ed8fc660da2bb6ae29b9895401c628da5740c048c190b5d7107cadd02/keras-pos-embd-0.11.0.tar.gz\n","Collecting keras-multi-head>=0.27.0\n","  Downloading https://files.pythonhosted.org/packages/e6/32/45adf2549450aca7867deccfa04af80a0ab1ca139af44b16bc669e0e09cd/keras-multi-head-0.27.0.tar.gz\n","Collecting keras-layer-normalization>=0.14.0\n","  Downloading https://files.pythonhosted.org/packages/a4/0e/d1078df0494bac9ce1a67954e5380b6e7569668f0f3b50a9531c62c1fc4a/keras-layer-normalization-0.14.0.tar.gz\n","Collecting keras-position-wise-feed-forward>=0.6.0\n","  Downloading https://files.pythonhosted.org/packages/e3/59/f0faa1037c033059e7e9e7758e6c23b4d1c0772cd48de14c4b6fd4033ad5/keras-position-wise-feed-forward-0.6.0.tar.gz\n","Collecting keras-embed-sim>=0.8.0\n","  Downloading https://files.pythonhosted.org/packages/57/ef/61a1e39082c9e1834a2d09261d4a0b69f7c818b359216d4e1912b20b1c86/keras-embed-sim-0.8.0.tar.gz\n","Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.6/dist-packages (from Jinja2>=2.7->bokeh->ktrain) (1.1.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers>=3.1.0->ktrain) (7.1.2)\n","Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.6/dist-packages (from traitlets>=4.2->ipython->ktrain) (0.2.0)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.6/dist-packages (from pexpect; sys_platform != \"win32\"->ipython->ktrain) (0.6.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.6/dist-packages (from prompt-toolkit<2.0.0,>=1.0.4->ipython->ktrain) (0.2.5)\n","Collecting keras-self-attention==0.46.0\n","  Downloading https://files.pythonhosted.org/packages/15/6b/c804924a056955fa1f3ff767945187103cfc851ba9bd0fc5a6c6bc18e2eb/keras-self-attention-0.46.0.tar.gz\n","Building wheels for collected packages: ktrain, keras-bert, langdetect, seqeval, syntok, keras-transformer, sacremoses, keras-pos-embd, keras-multi-head, keras-layer-normalization, keras-position-wise-feed-forward, keras-embed-sim, keras-self-attention\n","  Building wheel for ktrain (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for ktrain: filename=ktrain-0.22.1-cp36-none-any.whl size=25271136 sha256=f83960c4e7a03bf5c2a6d12531ba75bff876f5d5a4a32c1614e184cb22827f2b\n","  Stored in directory: /root/.cache/pip/wheels/ff/10/c0/d2b89a0090d36b31f8a7f278d29ff20b47fad3585e3a3b1d8b\n","  Building wheel for keras-bert (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-bert: filename=keras_bert-0.86.0-cp36-none-any.whl size=34145 sha256=7a5b269bbec335052f0ebdec34072417a97187a0a0f9b488f6bfda45d149bc85\n","  Stored in directory: /root/.cache/pip/wheels/66/f0/b1/748128b58562fc9e31b907bb5e2ab6a35eb37695e83911236b\n","  Building wheel for langdetect (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for langdetect: filename=langdetect-1.0.8-cp36-none-any.whl size=993195 sha256=452a09a64df9bf50441c1c1f456a18405c8a51207d0f9365f6c763ca2e080fb9\n","  Stored in directory: /root/.cache/pip/wheels/8d/b3/aa/6d99de9f3841d7d3d40a60ea06e6d669e8e5012e6c8b947a57\n","  Building wheel for seqeval (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for seqeval: filename=seqeval-0.0.19-cp36-none-any.whl size=9919 sha256=da4f4cdd5355c37a6f548c2d948272f21122c2afdf315af11f44bf151ff5ed58\n","  Stored in directory: /root/.cache/pip/wheels/8d/1f/bf/1198beceed805a2099060975f6281d1b01046dd279e19c97be\n","  Building wheel for syntok (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for syntok: filename=syntok-1.3.1-cp36-none-any.whl size=20919 sha256=70b384d7f94a37a7bfba9c68abb1064b45235adee514efc531505e7b8553f47a\n","  Stored in directory: /root/.cache/pip/wheels/51/c6/a4/be1920586c49469846bcd2888200bdecfe109ec421dab9be2d\n","  Building wheel for keras-transformer (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-transformer: filename=keras_transformer-0.38.0-cp36-none-any.whl size=12942 sha256=c9d1776a266d0aae738de27b1ccf1108d8528046940bdf89e5127515475fc7d6\n","  Stored in directory: /root/.cache/pip/wheels/e5/fb/3a/37b2b9326c799aa010ae46a04ddb04f320d8c77c0b7e837f4e\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.43-cp36-none-any.whl size=893257 sha256=2de84a69d3644beb68cec5ec5b1db59a1331e9f477cf65c54a86a6848a6630ad\n","  Stored in directory: /root/.cache/pip/wheels/29/3c/fd/7ce5c3f0666dab31a50123635e6fb5e19ceb42ce38d4e58f45\n","  Building wheel for keras-pos-embd (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-pos-embd: filename=keras_pos_embd-0.11.0-cp36-none-any.whl size=7554 sha256=bd82cad9c514348739d20e31371d3a7fe88b4d2473049eafd1b8a95baea0d413\n","  Stored in directory: /root/.cache/pip/wheels/5b/a1/a0/ce6b1d49ba1a9a76f592e70cf297b05c96bc9f418146761032\n","  Building wheel for keras-multi-head (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-multi-head: filename=keras_multi_head-0.27.0-cp36-none-any.whl size=15612 sha256=4f1368e734b1a291bb68cb14cc5766433459441aa853a7b110c94eabd2bbd69c\n","  Stored in directory: /root/.cache/pip/wheels/b5/b4/49/0a0c27dcb93c13af02fea254ff51d1a43a924dd4e5b7a7164d\n","  Building wheel for keras-layer-normalization (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-layer-normalization: filename=keras_layer_normalization-0.14.0-cp36-none-any.whl size=5268 sha256=02c487b007b0e06fc822b640748b572df0811bef26a67d4e5b310096e652beb8\n","  Stored in directory: /root/.cache/pip/wheels/54/80/22/a638a7d406fd155e507aa33d703e3fa2612b9eb7bb4f4fe667\n","  Building wheel for keras-position-wise-feed-forward (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-position-wise-feed-forward: filename=keras_position_wise_feed_forward-0.6.0-cp36-none-any.whl size=5626 sha256=ab1a4a500cc00c2d2da8e1a1edf794b07bf169d3617317a5763cb17e86b89cb9\n","  Stored in directory: /root/.cache/pip/wheels/39/e2/e2/3514fef126a00574b13bc0b9e23891800158df3a3c19c96e3b\n","  Building wheel for keras-embed-sim (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-embed-sim: filename=keras_embed_sim-0.8.0-cp36-none-any.whl size=4559 sha256=82ed6582a30fa911746f3f4758f9b79f0eab1618f3636b8d57588915d4b8b7e9\n","  Stored in directory: /root/.cache/pip/wheels/49/45/8b/c111f6cc8bec253e984677de73a6f4f5d2f1649f42aac191c8\n","  Building wheel for keras-self-attention (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-self-attention: filename=keras_self_attention-0.46.0-cp36-none-any.whl size=17278 sha256=6859595a99643c9c71749469cda6d646f61e67ba8bcb7ec783b72bb9329db70c\n","  Stored in directory: /root/.cache/pip/wheels/d2/2e/80/fec4c05eb23c8e13b790e26d207d6e0ffe8013fad8c6bdd4d2\n","Successfully built ktrain keras-bert langdetect seqeval syntok keras-transformer sacremoses keras-pos-embd keras-multi-head keras-layer-normalization keras-position-wise-feed-forward keras-embed-sim keras-self-attention\n","Installing collected packages: keras-pos-embd, keras-self-attention, keras-multi-head, keras-layer-normalization, keras-position-wise-feed-forward, keras-embed-sim, keras-transformer, keras-bert, langdetect, cchardet, seqeval, sacremoses, sentencepiece, tokenizers, transformers, syntok, whoosh, ktrain\n","Successfully installed cchardet-2.1.6 keras-bert-0.86.0 keras-embed-sim-0.8.0 keras-layer-normalization-0.14.0 keras-multi-head-0.27.0 keras-pos-embd-0.11.0 keras-position-wise-feed-forward-0.6.0 keras-self-attention-0.46.0 keras-transformer-0.38.0 ktrain-0.22.1 langdetect-1.0.8 sacremoses-0.0.43 sentencepiece-0.1.91 seqeval-0.0.19 syntok-1.3.1 tokenizers-0.8.1rc2 transformers-3.3.1 whoosh-2.7.4\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6sKw5xyv6MCN"},"source":["import pandas as pd\n","import ktrain\n","from ktrain import text"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"OJoNY0Al-cUh"},"source":["from  keras . utils  import  to_categorical\n","import numpy as np\n","from sklearn.model_selection import train_test_split\n"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"KwS1PsObIseS"},"source":["# Load the Data Into Arrays¶\n","\n"]},{"cell_type":"code","metadata":{"id":"XAIlXEUq6aK-"},"source":["df_train = pd.read_csv('drive/My Drive/Thesis Data/Our dataset/OurDataset_train.csv')\n","df_test = pd.read_csv('drive/My Drive/Thesis Data/Our dataset/OurDataset_test.csv')\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"mNHHlV4xtvf_"},"source":["#df_train = pd.read_csv('drive/My Drive/Colab Notebooks/ulm_train.csv')\n","#df_test = pd.read_csv('drive/My Drive/Colab Notebooks/ulm_test.csv')\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"1iAM7uAh6qam","executionInfo":{"status":"ok","timestamp":1602194154911,"user_tz":-360,"elapsed":1243,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"67d26376-de67-4309-ff37-b054438c11d6","colab":{"base_uri":"https://localhost:8080/","height":204}},"source":["df_train.tail()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>text</th>\n","      <th>is_valid</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>14369</th>\n","      <td>robindronath</td>\n","      <td>একবার কমলের মূর্ছা ভাঙিল, মূর্ছা ভাঙিয়া মাতার ...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>14370</th>\n","      <td>humayun_ahmed</td>\n","      <td>চলে যেতে পারে। যাওয়াটা কি ঠিক হবে? আপা নিশ্চয়ই...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>14371</th>\n","      <td>MZI</td>\n","      <td>পেটব্যথা করছে সার, বাসায় যেতে হবে এক্ষুণি। অঙ্...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>14372</th>\n","      <td>shomresh</td>\n","      <td>পৌঁছে সে ডরোথিকে দেখতে পেল। এই সকালবেলায় নরম র...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>14373</th>\n","      <td>shirshendu</td>\n","      <td>করে না। তুমি করো? না। আপনাকে আমি শিশুবয়স থেকে ...</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["               label  ... is_valid\n","14369   robindronath  ...    False\n","14370  humayun_ahmed  ...    False\n","14371            MZI  ...    False\n","14372       shomresh  ...    False\n","14373     shirshendu  ...    False\n","\n","[5 rows x 3 columns]"]},"metadata":{"tags":[]},"execution_count":11}]},{"cell_type":"code","metadata":{"id":"qcZCT6Q3LAEv"},"source":["total_data = df_train\n","total_data=total_data.append(df_test, ignore_index = True) \n","authors_name = list(set(total_data['label']))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"dOzsICEWN7UJ","executionInfo":{"status":"ok","timestamp":1602194231574,"user_tz":-360,"elapsed":987,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"b5dac611-1ae4-4690-c69b-9a744053030b","colab":{"base_uri":"https://localhost:8080/","height":289}},"source":["authors_name"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['MZI',\n"," 'bongkim',\n"," 'shottojit_roy',\n"," 'shirshendu',\n"," 'humayun_ahmed',\n"," 'nihar_ronjon_gupta',\n"," 'robindronath',\n"," 'nazrul',\n"," 'toslima_nasrin',\n"," 'zahir_rayhan',\n"," 'shorotchandra',\n"," 'shomresh',\n"," 'tarashonkor',\n"," 'shordindu',\n"," 'manik_bandhopaddhay',\n"," 'shunil_gongopaddhay']"]},"metadata":{"tags":[]},"execution_count":16}]},{"cell_type":"code","metadata":{"id":"PMY_zqCVBwLF"},"source":["def get(data):\n","\n","  macronum=sorted(set(data['label']))\n","  macro_to_id = dict((note, number) for number, note in enumerate(macronum))\n","\n","  def fun(i):\n","      return macro_to_id[i]\n","\n","  data['label']=data['label'].apply(fun)\n","\n","  return list(data['text']) , list(to_categorical(np.asarray(data['label']), num_classes=16)) # return text and label\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"haNW90SIHNTS"},"source":["x , y = get(total_data)\n","x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=1)\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"J1qIHYnnL4bW","executionInfo":{"status":"ok","timestamp":1602194272882,"user_tz":-360,"elapsed":1478,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"861b7e8e-b14c-46fc-8c2f-0239c14164f6","colab":{"base_uri":"https://localhost:8080/","height":289}},"source":["authors_name"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['MZI',\n"," 'bongkim',\n"," 'shottojit_roy',\n"," 'shirshendu',\n"," 'humayun_ahmed',\n"," 'nihar_ronjon_gupta',\n"," 'robindronath',\n"," 'nazrul',\n"," 'toslima_nasrin',\n"," 'zahir_rayhan',\n"," 'shorotchandra',\n"," 'shomresh',\n"," 'tarashonkor',\n"," 'shordindu',\n"," 'manik_bandhopaddhay',\n"," 'shunil_gongopaddhay']"]},"metadata":{"tags":[]},"execution_count":19}]},{"cell_type":"markdown","metadata":{"id":"lvnAN_KkI1ht"},"source":["# STEP 1: Preprocess Data¶\n","\n","1.   List item\n","2.   List item\n","\n","\n","\n"]},{"cell_type":"code","metadata":{"id":"drxn1lLuH0xk","executionInfo":{"status":"ok","timestamp":1602195387061,"user_tz":-360,"elapsed":324927,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"590a9a9f-c51d-4f76-cf0e-46dec8f2bbd5","colab":{"base_uri":"https://localhost:8080/","height":353,"referenced_widgets":["ede2cdee80b14e47a2f3c2db215ecfd5","1c6037682b884c88a0a2a3be518409db","b0bcdd3057f24fe985a8e4389b82e561","1b1efae2b76f4ae3a59c1b9f0667e9aa","879fd15d70244513a4e3d6c00dce311a","26a3155997364fc6afec7c31c6368b34","17bda29b523b4a31956dec37f5fa8676","e9da21340d0445d581bc6c8b857423be","a65b4c54df514a4984b0666fe7073281","1d478e6c21c24ea7bfb4cfd1cb117dfb","821936bd7f8f4bd4945f0fdab5c24336","c43c90cb22534b22ab86f0941d80adda","1b1fec41cff04635ac9992f9557badf6","70a37fadfbd9482cad8cdc2905c99503","15cc16cbfd864f72945ef2f5e4f9266a","91a19896d3b2425f92e21072a50b04d6"]}},"source":["trn, val, preproc = text.texts_from_array(x_train=x_train, y_train=y_train,\n","                                          x_test=x_test, y_test=y_test,\n","                                          class_names=authors_name,\n","                                          preprocess_mode='distilbert',\n","                                          maxlen=512)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ede2cdee80b14e47a2f3c2db215ecfd5","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=466.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","preprocessing train...\n","language: bn\n","train sequence lengths:\n","\tmean : 750\n","\t95percentile : 750\n","\t99percentile : 750\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a65b4c54df514a4984b0666fe7073281","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=995526.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"text/html":[""],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Is Multi-Label? False\n","preprocessing test...\n","language: bn\n","test sequence lengths:\n","\tmean : 750\n","\t95percentile : 750\n","\t99percentile : 750\n"],"name":"stdout"},{"output_type":"display_data","data":{"text/html":[""],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["task: text classification\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"j7YvIdvrPU_w"},"source":["# STEP 2: Build a Model and Wrap in Learner¶\n","\n"]},{"cell_type":"code","metadata":{"id":"cOQvWdBtCHE-","executionInfo":{"status":"ok","timestamp":1602195587936,"user_tz":-360,"elapsed":1315,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"040648c3-0f50-40db-f111-c4ef281895b6","colab":{"base_uri":"https://localhost:8080/","height":136}},"source":["text.print_text_classifiers()\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["fasttext: a fastText-like model [http://arxiv.org/pdf/1607.01759.pdf]\n","logreg: logistic regression using a trainable Embedding layer\n","nbsvm: NBSVM model [http://www.aclweb.org/anthology/P12-2018]\n","bigru: Bidirectional GRU with pretrained fasttext word vectors [https://fasttext.cc/docs/en/crawl-vectors.html]\n","standard_gru: simple 2-layer GRU with randomly initialized embeddings\n","bert: Bidirectional Encoder Representations from Transformers (BERT) [https://arxiv.org/abs/1810.04805]\n","distilbert: distilled, smaller, and faster BERT from Hugging Face [https://arxiv.org/abs/1910.01108]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"24SndJ6vOyUp","executionInfo":{"status":"ok","timestamp":1602195637350,"user_tz":-360,"elapsed":34838,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"88545a1c-fe82-4115-d842-1414b6370677","colab":{"base_uri":"https://localhost:8080/","height":117,"referenced_widgets":["d22de94c6b4e4882907f1f6bc39b6554","8c98be5b185b4bdbbd4276863f3614e7","b2d8c69b90eb4e4e81f7411b6aa4516d","50c8d470087c405a8671178e2999538b","e7803ec4431b4f5e98ac139e71c6e611","b3d02cff1332439f85ebc275cab6dd2e","98345303d8c54a24af0bceda3ffb14bf","8d45290336d14327821bfa217cd6aa35"]}},"source":["model = text.text_classifier('distilbert', train_data=trn, preproc=preproc)\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Is Multi-Label? False\n","maxlen is 512\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d22de94c6b4e4882907f1f6bc39b6554","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=910749124.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","done.\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-jY-zTcv9Rbo"},"source":["learner = ktrain.get_learner(model, train_data=trn, val_data=val, batch_size=6)\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"34SbWwlc7H-P"},"source":[""],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"WNaibfSSPQyT"},"source":["# STEP 3: Train Model¶\n"]},{"cell_type":"code","metadata":{"id":"6SJp48JePTCU","executionInfo":{"status":"ok","timestamp":1602199927085,"user_tz":-360,"elapsed":1129717,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"c4166508-866a-4c9f-b138-abd400a898a8","colab":{"base_uri":"https://localhost:8080/","height":221}},"source":["learner.fit_onecycle(3e-5, 4)\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\n","\n","begin training using onecycle policy with max lr of 3e-05...\n","Epoch 1/4\n","2246/2246 [==============================] - 1051s 468ms/step - loss: 1.6941 - accuracy: 0.4828 - val_loss: 0.8636 - val_accuracy: 0.7346\n","Epoch 2/4\n","2246/2246 [==============================] - 1060s 472ms/step - loss: 0.5829 - accuracy: 0.8246 - val_loss: 0.3929 - val_accuracy: 0.8791\n","Epoch 3/4\n","2246/2246 [==============================] - 1060s 472ms/step - loss: 0.2426 - accuracy: 0.9293 - val_loss: 0.2127 - val_accuracy: 0.9348\n","Epoch 4/4\n","2246/2246 [==============================] - 1060s 472ms/step - loss: 0.0738 - accuracy: 0.9791 - val_loss: 0.1466 - val_accuracy: 0.9577\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["<tensorflow.python.keras.callbacks.History at 0x7fd608e13828>"]},"metadata":{"tags":[]},"execution_count":25}]},{"cell_type":"code","metadata":{"id":"fDitMXS-xaFz","executionInfo":{"status":"ok","timestamp":1602200998610,"user_tz":-360,"elapsed":984211,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"6a784b9b-438c-4937-8353-d3502b7cb978","colab":{"base_uri":"https://localhost:8080/","height":401}},"source":["learner.lr_find(max_epochs=10 , show_plot=True)\n"],"execution_count":null,"outputs":[{"output_type":"stream","text":["simulating training for different learning rates... this may take a few moments...\n","Epoch 1/10\n","2245/2245 [==============================] - 964s 429ms/step - loss: 0.0311 - accuracy: 0.9941\n","\n","\n","done.\n","Visually inspect loss plot and select learning rate associated with falling loss\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAY4AAAEJCAYAAACDscAcAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU9b3/8dcnmWyEkLCELSxhU1QQEMR9aa2W2gVttdpatdWqvV5ve29/t7faXm2vt5u37e3tYhetK71WvS6VuhRr1Vo3JCjIJhUQhKgkQIAkkEyS+fz+OAeMcQJzIJOZJO/n4zGPOfOd7znzmWRm3nOW+R5zd0RERFKVk+kCRESkZ1FwiIhIJAoOERGJRMEhIiKRKDhERCQSBYeIiEQSy3QB3WHIkCFeWVmZ6TJERHqMIUOGsGDBggXuPqfjfX0iOCorK6mqqsp0GSIiPYqZDUnWrk1VIiISiYJDREQiUXCIiEgkCg4REYlEwSEiIpEoOEREJBIFh4iIRKLgEBHphR5d9jaVVz9COs65pOAQEemFvn7/qwDsbGrt8mUrOEREJBIFh4iIRJLW4DCzOWa22szWmNnVSe4vMLN7wvsXmlll2D7bzJaEl6Vmdna7edab2bLwPg1AJSLSzdI2yKGZ5QI3AqcDm4BFZjbf3Ve263YpUOfuE83sfOAG4DxgOTDL3VvNbASw1Mz+6O57NtZ9wN23pKt2ERHpXDrXOGYDa9x9nbvHgbuBuR36zAXuCKfvA04zM3P3Xe1CohDo+sMCRETkgKQzOCqAje1ubwrbkvYJg2IHMBjAzI4xsxXAMuBL7YLEgcfNbLGZXZ7G+kVEJImsPR+Huy8EjjCzw4A7zOwxd28CTnT3ajMbCvzZzF5z92c6zh+GyuUAY8aM6dbaRUR6s3SucVQDo9vdHhW2Je1jZjGgFNjavoO7rwIagCnh7erwugZ4kGCT2Pu4+03uPsvdZ5WXlx/0kxERkUA6g2MRMMnMxplZPnA+ML9Dn/nAxeH0OcCT7u7hPDEAMxsLTAbWm1mxmZWE7cXAGQQ70kVEpJukbVNVeETUVcACIBe41d1XmNn1QJW7zwduAeaZ2RpgG0G4AJwIXG1mLUACuNLdt5jZeOBBM9tT+13u/qd0PQcREXm/tO7jcPdHgUc7tF3XbroJODfJfPOAeUna1wHTur5SERFJlX45LiIikSg4REQkEgWHiIhEouAQEZFIFBwiIhKJgkNERCJRcIiISCQKDhERiUTBISIikSg4REQkEgWHiIhEouAQEZFIFBwiIhKJgkNERCJRcIiISCQKDhERiUTBISIikSg4REQkEgWHiIhEouAQEZFIFBwiIr3QxcdVAlAQ6/qPeQWHiEgv1K8gN23LVnCIiEgkCg4REYlEwSEiIpGkNTjMbI6ZrTazNWZ2dZL7C8zsnvD+hWZWGbbPNrMl4WWpmZ2d6jJFRCS90hYcZpYL3Ah8BDgc+IyZHd6h26VAnbtPBH4C3BC2Lwdmuft0YA7wGzOLpbhMERFJo3SuccwG1rj7OnePA3cDczv0mQvcEU7fB5xmZubuu9y9NWwvBDzCMkVEJI3SGRwVwMZ2tzeFbUn7hEGxAxgMYGbHmNkKYBnwpfD+VJYpIiJplLU7x919obsfARwNXGNmhVHmN7PLzazKzKpqa2vTU6SISB+UzuCoBka3uz0qbEvax8xiQCmwtX0Hd18FNABTUlzmnvlucvdZ7j6rvLz8IJ6GiIi0l87gWARMMrNxZpYPnA/M79BnPnBxOH0O8KS7ezhPDMDMxgKTgfUpLlNERNIolq4Fu3urmV0FLABygVvdfYWZXQ9Uuft84BZgnpmtAbYRBAHAicDVZtYCJIAr3X0LQLJlpus5iIjI+6UtOADc/VHg0Q5t17WbbgLOTTLfPGBeqssUEZHuk7U7x0VEJDspOEREJBIFh4iIRKLgEBGRSBQcIiISiYJDREQiUXCIiEgkCg4REYlEwSEiIpEoOEREJBIFh4iIRKLgEBGRSBQcIiISiYJDREQiUXCIiEgkCg4REYlEwSEiIpEoOEREJBIFh4iIRKLgEBGRSBQcIiISiYJDREQiUXCIiEgkCg4REYlEwSEiIpEoOEREJJK0BoeZzTGz1Wa2xsyuTnJ/gZndE96/0Mwqw/bTzWyxmS0Lrz/Ybp6nw2UuCS9D0/kcRETkvWLpWrCZ5QI3AqcDm4BFZjbf3Ve263YpUOfuE83sfOAG4DxgC/Bxd3/LzKYAC4CKdvNd4O5V6apdREQ6l841jtnAGndf5+5x4G5gboc+c4E7wun7gNPMzNz9FXd/K2xfARSZWUEaaxURkRSlMzgqgI3tbm/ivWsN7+nj7q3ADmBwhz6fAl529+Z2bbeFm6muNTPr2rJFRGRfsnrnuJkdQbD56op2zRe4+1TgpPByYSfzXm5mVWZWVVtbm/5iRUT6iHQGRzUwut3tUWFb0j5mFgNKga3h7VHAg8BF7r52zwzuXh1e1wN3EWwSex93v8ndZ7n7rPLy8i55QiIikt7gWARMMrNxZpYPnA/M79BnPnBxOH0O8KS7u5mVAY8AV7v7c3s6m1nMzIaE03nAx4DlaXwOIiLSQdqCI9xncRXBEVGrgHvdfYWZXW9mnwi73QIMNrM1wFeBPYfsXgVMBK7rcNhtAbDAzF4FlhCssdycrucgIiLvl7bDcQHc/VHg0Q5t17WbbgLOTTLfd4DvdLLYmV1Zo4iIRJPVO8dFRCS61rYEjc2taVt+Wtc4RESk6zU0t7Kpbhdvbd9N9fam4LpuN29tDy7v7Gwi4ZCXa+TmdP0vFhQcIiJZKJFwqrfvZt2WRtbWNLC2toF1tY2srW2gpr75PX3zco0RpUWMLCvkuAlDqCgrZGRZEVMqSsnL7foNSwoOEZEMamlLsLa2gdXv1LM2DIa1NQ2s39pIU0tib7/SojwmlBdz8iHljC8vZsygfowsK2JUWRFD+heQk4Y1i84oOEREuklTSxsr3trJird2sPKtnax4ayerN9cTbw0CIsdg9KB+TCjvz0mThjC+vD8TyvszvryYwcX5ZMtAGQoOEZE0qWuMs3hDHYs2bKNqfR3LNu0g3haExMB+eRwxspTPH1/JESMHMHn4ACqH9KMglpvhqvdPwSEi0kVqdjbx3NotvPTGNhatr2NNTQMQ7IOYWlHKF06o5KixA5laUcqI0sKsWYOISsEhInKAdsfbWPjGVp59fQt/e30LqzfXAzCgMMbMsQM5e0YFR1cO4shRpRTmZf+aRKoUHCIiKXJ3Vm+u56nXavnb67VUra8j3pYgP5bD0ZUDOfuoyZw4cQiHjxjQrTuru5uCQ0RkH9oSzitv1rFgxTs8vnIzG7buAmDy8BIuPn4sJ04qZ3blIIrye88axf4oOESkz0oknLpdcbY0xNmxu4Wdu1vY2RRc1ze1srFuF0++VsuWhmbyco3jJwzhipMncNphQxk2oDDT5WdMSsFhZl8BbgPqgd8CMwhGrn08jbWJiByw1rYEm+ubqa7bzaa6XeH1bjbXN1Fb38yWhma2NMRpS3inyxhQGOPkQ8o544jhfODQckoK87rxGWSvVNc4LnH3n5rZh4GBBCdPmgcoOEQko3bsamFNbfDL6uDHc8GP6DZu20Vrh1AY0r+A4aUFDBtQyBEjB1BeUkB5/wKGlBRQVpTPgKIYAwrzKCmMUVKYR35Mw/klk2pw7NnLcyYwLxwevffu+RGRbtPSlmDn7hYam9toaG6lMd4aXDe3siveRnNLG7tb2mhqSbC7pY3d8Ta2NsbZvKOJdVsa2dLw7vAb+bk5jBtSzGEjSvjIlOGMHtSPirIiKgYWUVFW1KuObMqkVINjsZk9DowDrjGzEiCxn3lEJMu4Oy1tTktbgnhrgnh4/e794TXv/aaem2PEcnLIyYFYTg65ZuTmGrEcI8fC6w5HEbUlnJr6YAC+TXW7qd6+m3d2NLG1IU5tQzNbG5rZ2hhn+66WlOvPyzUK83IZXJzP0JJCPji5nIlDg19XTyjvz+hB/dIyqJ+8V6rBcSkwHVjn7rvMbBDwhfSVJSIdJRJOvC1BS1uC5tYE23e1sH1XnLpdLdTtiu+d3r4rTl3jnrbgele87X0h0dViOUZBLIeCvFxiOca2xvj7NhUNKIxRXlLA4P4FHDq8hMHFBQzun8/AfvkUF8ToX5BLcUEsnI7RLz+XwrzwEsshloYB+yS6VIPjOGCJuzea2eeAo4Cfpq8skd6htS1BbUNzeMROKzt3twTTTcFRO43xVnY1t9EYf3fTzJ7rXfE2mlrCS2tqH/qxHKOsXz4D++UxsF8+Ywf3Y/roMooLYuTFjILcHPJjOeSF1/mxHPJyct6ztrBnas/GaHdoc6ct4bQmnER43ZZI0JaAtkSC1kSwFtPcEoRavDXBoP75ezcTjSorYmRZEcUFOpCzN0j1v/grYJqZTQP+H8GRVXcCp6SrMJGeor6phb9vrufvm4MdstXhORGq6949L0Jn8mM5FOfn0i8//IZdkEv/guBbeVHeu9+2C/JyKIwF1/m5wQd/aVEeZWFADOyXz8DiPPoXxHrsMBbSc6QaHK3u7mY2F/iFu99iZpemszCRZBIJp6a+mc07m6ipb6amvomanc3BdNi2s6mFeOu733wBYrnBNvq8XCOWa+Tl5lBSEGNAUR4DCvP2Hk0zoCiPQcX5DCrOZ/De6wIGFAUfyM2tbSyv3sGi9XUs3lDHyrd2Ur199976YjnG8NJCKsqKOHbCYCrKihhRWkRZv/c/Tv+CmI7akR4p1eCoN7NrCA7DPcnMcgAd0Cxp1dTSxtKN23n5ze28vrme12saWFPTwO6Wtvf1HVycT3lJcJjluCHF4bb2HPJzg6NoWhMJWtqc1rZgs0q8LUFDUys7m1p4a/tudjYFm5GaO9kcFMsxBhbns2N3y94wGjekmJljB/LZY8Zw6LASDh1ewsiyIu2clV4v1eA4D/gswe853jGzMcAP01eW9EWJhLN003aeWLWZF9dte88Q1CNKC5k4tD/nzx7N+PL+DB9QyNCSAoYOKGBI/4IuO8tZU0sb2xrjbGuMs7UxzrbGZrY2xPe2lRTGmDl2EDPHDqS8pKBLHlOkpzH3fWyAbd/RbBhwdHjzJXevSVtVXWzWrFleVVWV6TIkCXdn4RvbeOTVt3l85Tts3tlMbo5x5KhSZlcO4ujK4EN6YHF+pksV6XPMbLG7z+rYnuqQI58mWMN4muCgi5+b2dfc/b4urVL6jLrGOPe/vIm7Fr7Jui2NFOblcMoh5Xz4iOGcNnkYpf20JVQkW6W6qeqbwNF71jLMrBx4AlBwSCRvbd/Nz598nftfribemuCoMWX8+NxpnDl1RJ8aXVSkJ0s1OHI6bJraCuhwEElZbX0zNz61hrsWvgnAObNGceGxYzlsxIAMVyYiUaUaHH8yswXA78Pb5wGP7m8mM5tD8EPBXOC37v6DDvcXEPweZCZBGJ3n7uvN7HTgB0A+EAe+5u5PhvPMBG4HisIavuKp7qiRbretMc5Nz6zjjufXE29LcM5Ro/jyhyZRUVaU6dJE5AClFBzu/jUz+xRwQth0k7s/uK95zCwXuBE4HdgELDKz+e6+sl23S4E6d59oZucDNxCE0hbg4+7+lplNARYAFeE8vwIuAxYSBMcc4LFUnod0n22NcW7+WxAYu1va+PiRI/nnD01ifHn/TJcmIgcp5d//u/v9wP0Rlj0bWOPu6wDM7G5gLtA+OOYC3w6n7wN+YWbm7q+067MCKArXTgYBA9z9xXCZdwJnoeDIGg3Nrdz0zDpu+ds6doWB8eXTJjJxaEmmSxORLrLP4DCzeiDZZiAD3N33tYG6AtjY7vYm4JjO+rh7q5ntAAYTrHHs8SngZXdvNrOKcDntl1mBZFy8NcHvX3qTn/3ldbY2xjlz6nD+5UOHMGmYAkOkt9lncLh7Rt/1ZnYEwearMw5g3suBywHGjBnTxZXJHomE88iyt/nR46vZsHUXx4wbxC1nHsb00WWZLk1E0iSdQ1VWA6Pb3R4VtiXrs8nMYkApwU5yzGwU8CBwkbuvbdd/1H6WCYC73wTcBMEPAA/qmUhSz6/Zwvcfe41l1TuYPLyE275wNKceUq5B9kR6uXQGxyJgkpmNI/hwP59g2JL25gMXAy8A5wBPhoMplgGPEJzX/Lk9nd39bTPbaWbHEuwcvwj4eRqfgySxcdsurn1oOU+vrqWirIgfnzuNs2ZUaIwmkT4ibcER7rO4iuCIqFzg1vCUs9cDVe4+H7gFmGdma4BtBOECcBUwEbjOzK4L284If0tyJe8ejvsY2jHebRIJ584X1vNfC1ZjwDfOnMxFx1XqdJwifUzKY1X1ZBqr6uCtrW3g6/e9StWGOk45pJzvfXKqfosh0ssd1FhV0rc9+MomvvHAcvJjOfzo3Gl86qgK7ccQ6cMUHNKp1rYE1z+8kjtf2MDsykH8/LMzGDagMNNliUiGKTgkqYbmVq6662WeXl3LZSeN4+tzJhPronNeiEjPpuCQ99nZ1MKFt7zE8uodfP+TU/nMbP0ORkTepeCQ92hobuXzt77Eiuod/PpzMzn98GGZLklEsoyCQ/baFW/lktsWsXTTDm787AyFhogkpY3WAsDueBuX3L6Iqg3b+On505kzZUSmSxKRLKXgEJpa2rjszipeemMbPzlvOh87cmSmSxKRLKZNVX1cc2sbV8xbzHNrt/Cjc6Yxd7oGGxaRfdMaRx+WSDhfvXcpf/17LT/45FQ+NXPU/mcSkT5PwdGH3bDgNR559W2+ceZkzjtah9yKSGoUHH3UvYs28pu/ruPCY8dy2UnjM12OiPQgCo4+aMnG7fz7H5Zz0qQhfOvjh2vcKRGJRMHRx2xtaOYffreYoQMK+Nn5MzSMiIhEpqOq+hB35+v3v8rWhjgPXHk8A4vzM12SiPRA+rrZh/xu4Zs8saqGqz8ymSkVpZkuR0R6KAVHH7GutoHvPLySUw4p5wsnVGa6HBHpwRQcfUAi4VzzwDIKYjn88JwjtTNcRA6KgqMPuKdqIwvf2MY3P3oYQ3UiJhE5SAqOXm5LQzPfe3QVx44fxKdnjc50OSLSCyg4erkfP76a3fE2vnPWVG2iEpEuoeDoxZZX7+DuRRu5+PhKJg7tn+lyRKSXUHD0Ujt2tXDtQ8sZ2C+fL582KdPliEgvoh8A9kJPra7h6vtfZUtDnP/+9DRKi/IyXZKI9CIKjl7E3bnxqTX86PG/c+iwEn570dFMHaUf+olI10rrpiozm2Nmq81sjZldneT+AjO7J7x/oZlVhu2DzewpM2sws190mOfpcJlLwsvQdD6HnqKppY0v372EHz3+d86aPpKHrjpBoSEiaZG2NQ4zywVuBE4HNgGLzGy+u69s1+1SoM7dJ5rZ+cANwHlAE3AtMCW8dHSBu1elq/ae5p0dTVw+r4pl1Tv4+pzJfOmU8TqCSkTSJp1rHLOBNe6+zt3jwN3A3A595gJ3hNP3AaeZmbl7o7s/SxAgsg9LNm7nE794lrU1Ddx84Sz+4dQJCg0RSat0BkcFsLHd7U1hW9I+7t4K7AAGp7Ds28LNVNdaH/6UnL/0LT79mxcozMvlwX88gQ8dPizTJYlIH9ATD8e9wN2nAieFlwuTdTKzy82sysyqamtru7XA7nDnC+v5yt2vMH10GX/4xxM4ZFhJpksSkT4incFRDbQf42JU2Ja0j5nFgFJg674W6u7V4XU9cBfBJrFk/W5y91nuPqu8vPyAnkC2+tXTa7nuoRWcNnkYd14ym0E6r4aIdKN0BsciYJKZjTOzfOB8YH6HPvOBi8Ppc4An3d07W6CZxcxsSDidB3wMWN7llWex2597gxv+9BqfmDaSX3/uKArzcjNdkoj0MWk7qsrdW83sKmABkAvc6u4rzOx6oMrd5wO3APPMbA2wjSBcADCz9cAAIN/MzgLOADYAC8LQyAWeAG5O13PINn94pZpv/3ElZxw+jB9/eppO+yoiGWH7+ILfa8yaNcurqnr20buvbtrOOb9+gRmjy7jz0tkUxLSmISLpZWaL3X1Wx3Z9Ze0BauubuWLeYsr7F/DLC45SaIhIRmnIkSwXb01w5f8upm5XnPv/4XgG9y/IdEki0scpOLLc9Q+vYNH6On72mRkcMVJDiIhI5mlTVRZ7aEk1v3vxTa44ZTyfmDYy0+WIiAAKjqxVs7OJ6x5awVFjyvi3D0/OdDkiInspOLKQu/ONB5fR1NLGj86dRm5Onx1VRUSykIIjCz386ts8saqGr334UMaX65SvIpJdFBxZprG5le8+soopFQP4wgnjMl2OiMj76KiqLPOzJ1/nnZ1N3HjBUdpEJSJZSWscWeS5NVu49dk3OGfmKGaOHZjpckREklJwZImq9dv44h1VjB/Sn3//6GGZLkdEpFMKjiyw+p16vnD7IkaUFjLvi7Mp66dh0kUkeyk4MqxmZxOX3L6Iorxc5n3xGIaWFGa6JBGRfdLO8QyKtya47M4q6nbFufeK46goK8p0SSIi+6XgyKAf/3k1Szft4Nefm8mUCo1DJSI9gzZVZcjza7dw0zPr+OwxY5gzZXimyxERSZmCIwO274rz1XuWMm5wsY6gEpEeR5uqupm7880Hl7OloZkHrzyBfvn6F4hIz6I1jm52/8vVPLLsbb56xiFMHaX9GiLS8yg4utG2xjjX/3EFsysHccXJEzJdjojIAVFwdKMfP76axngb3z17isahEpEeS8HRTZZX7+Cul97kouPGMmlYSabLERE5YAqObpBION+av4KB/fL55w8dkulyREQOioKjG9y9aCOLN9RxzUcmU1qUl+lyREQOioIjzWrqm/j+Y6s4dvwgzpk5KtPliIgctLQGh5nNMbPVZrbGzK5Ocn+Bmd0T3r/QzCrD9sFm9pSZNZjZLzrMM9PMloXz/MzMsnov8w8ee43mlgTfPXsqWV6qiEhK0hYcZpYL3Ah8BDgc+IyZHd6h26VAnbtPBH4C3BC2NwHXAv+aZNG/Ai4DJoWXOV1ffddY/U49D75SzedPqGSCzh0uIr1EOtc4ZgNr3H2du8eBu4G5HfrMBe4Ip+8DTjMzc/dGd3+WIED2MrMRwAB3f9HdHbgTOCuNz+Gg/HDBavoXxLjyVP1mQ0R6j3QGRwWwsd3tTWFb0j7u3grsAAbvZ5mb9rPMrLB4Qx1PrNrMl06ZoBMziUiv0mt3jpvZ5WZWZWZVtbW13f74v3xqDYOL8/nCCZXd/tgiIumUzuCoBka3uz0qbEvax8xiQCmwdT/LbH9oUrJlAuDuN7n7LHefVV5eHrH0g7O2toG/vFbDhceN1SCGItLrpDM4FgGTzGycmeUD5wPzO/SZD1wcTp8DPBnuu0jK3d8GdprZseHRVBcBD3V96Qfn1mffID+Ww+eOHZvpUkREulzavg67e6uZXQUsAHKBW919hZldD1S5+3zgFmCema0BthGECwBmth4YAOSb2VnAGe6+ErgSuB0oAh4LL1mjrjHO/S9v4qzpIxnSvyDT5YiIdLm0bkdx90eBRzu0Xdduugk4t5N5KztprwKmdF2VXeveqo00tSS45MRxmS5FRCQteu3O8Uxwdx54uZoZY8qYPHxApssREUkLBUcXWvn2TlZvrueTM7LyCGERkS6h4OhCf3ilmrxc42NHjsx0KSIiaaPg6CJtCeehJW9x6qFDGVisH/yJSO+l4OgiL6zdSk19szZTiUivp+DoIn9e+Q6FeTl8YPLQTJciIpJWCo4u4O785bUaTpxYTmFebqbLERFJKwVHF3i9poFNdbs57TCtbYhI76fg6AJ/WVUDwAcOVXCISO+n4OgCT762mSkVAxheWpjpUkRE0k7BcRASCeflN+tYvKGOD04elulyRES6hcb8jqixuZVn12zhyVU1PLW6hpr6ZgrzcvjYkSMyXZqISLdQcKSoav02fvn0Wp59fQvxtgQlBTFOPqScD04eyimHlmskXBHpMxQc+9DSluDPKzfzuxc38PzarQzpn8/Fx4/lg5OHMatyIHm52tInIn2PgqMTiYTz4Z88w7otjVSUFfGNMyfzuWN1Rj8REX0KdiInx7js5PEMH1DIyYeUk5tjmS5JRCQrKDj24TOzx2S6BBGRrKON9CIiEomCQ0REIlFwiIhIJAoOERGJRMEhIiKRKDhERCQSBYeIiESi4BARkUjM3TNdQ9qZWS2wIdN1pKAU2JHpIiJSzemlWrteT6gzG2rcAuDuczre0SeCo6cws5vc/fJM1xGFak4v1dr1ekKd2V6jNlVllz9muoADoJrTS7V2vZ5QZ1bXqDUOERGJRGscIiISiYJDREQiUXCIiEgkOh9HH2JmJwEXEPzfD3f34zNcUkp6Wt2qt+tkc2370hPqPqga3V2XTi7ArUANsHwffeYAq4E1wNVh22jgKWAlsAL4SjrqSPbYqdQNnAX8LNm84f25wCvAw91Rd4S/c3XYr/1zLQPuA14DVgHHZXm9/xK+JpYDvwcKs+x18dz+nls66jvQ2rr5vbYDaAXeSXX+sO4rMvG+irC8vTWmPM/Bvjh68wU4GThqHy/mXGAtMB7IB5YChwMjgKPCPiXA3wkSveP8Q4GSDm0TU6mjs8cO7/s88AywE3g4vAxtN+//AeuSzRve/1Xgrs5e4Gmo+8Kw3+vt6t1bd7t5HgEGdXiudwBfDKfzgbJsrReoAN4AisJl3wt8PoteF/cCH+64zAOpLWp9Yd9Pd6htb32d1Ub3vtfOA2YDu9v9Tad2qPd54DTeDY579zwu3f++6qzGZP/3kmQ1dXbJ+Idztl+Ayn28iY4DFrS7fQ1wTZJ+DwGnJ2k/F/gLUBDevgx4LJU69vfYndUNjAnrSTovMCqs6YP7eIF3ed0p/J3/CtzcYZ5Sgg9i28//MFvqrQA2EoRJLHwDn5FFr4ub99Unam1R6zvY2rrjvRbe9w5J3ucd5+9Qd0beV/t6X3T820a5aOf4wdnzQbDHprBtLzOrBGYACzvO7O7/BywA7jGzC4BLCF48XfLYnbg0rKWzef8H+Dcg0dkCMlB3BcG3yds6zDMOqAVuM7NXzOy3ZlacrfW6ezXwI+BN4G1gh7s/ngX1QvC6uG1/nQ6ytgOtL6XauhtfRgkAAAb/SURBVPG91kL0v2k2vq861pgyBUcamVl/4H7gn919Z7I+7v5fQBPwK+AT7t6Qzprc/VsEq/PvY2YfA2rcfXEKy+nWuoGX3f35Dm0xglX2X7n7DKCRYB/E+2RDvWY2EJhLEHgjgWIz+1w21Ovu30ry9+2sb9bVlq3vNXd/PpvfV1H+7+0pOA5ONcHOuT1GhW2YWR7BC/l/3f2BzhYQHtkwBXgQ+FZXPPZBzHsC8AkzWw/cDXzQzH6XBXV3Ns8mYJO77/mGeR9BkGRrvR8C3nD3WndvAR4Akh7JkqHXRUoOojZIQ30ZeK/lEa3mbH1fHbio27b62oV9b++NEexkHse7O6SOAAy4E/if/Sx7BsGRQBMIQvz3wHdSqaOzxz6Yujv0OZXOt8V2ed0HWi/wN+DQcPrbwA+ztV7gGIIjf/qFr5E7gH/KltdFiq+dlGuLWt+B1Eb3v9cmEewcPyLVGjP5vtrX3+RgLmlZaG+5hP+4twm2aW4CLg3bHwVGhtNnEmz6WQt8M2w7EXDgVWBJeDkzyfJPAKa2u50HXBahjvc99sHUHeEF3qV1H0y9wHSgKvxb/wEYmOX1/gfBocPLgXmEO0Kz6HWRtE/U2qLWd6C10b3vtZ0Eh+O2HcTf71S66X3VVZ+DyS4a5FBERCLRPg4REYlEwSEiIpEoOEREJBIFh4iIRKLgEBGRSBQcIiISiYJDso6ZpXs4EMzsS2Z2Ubofp8NjnmVmhx/gfNeF0982s3/t+uqiM7NTzezh/fSZama3d1NJ0k10Iifptcws193bkt3n7r/u7sckOO/BwwTnjoji34BPHFRhGeLuy8xslJmNcfc3M12PdA2tcUhWM7OvmdkiM3vVzP6jXfsfzGyxma0ws8vbtTeY2Y/NbClwXHj7u2a21MxeNLNhYb+939zN7Gkzu8HMXjKzv4fjBWFm/czsXjNbaWYPmtlCM5uVpMb14fwvA+ea2WVhzUvN7P5wOccTfPj/0MyWmNmE8PKn8Hn8zcwmJ1n2IUCzu29Jct/08Dm9GtY3MGw/OmxbYmY/NLPlSeYdYWbPhH2Wt3vOc8zs5bD2v4Rts83shXAE4ufN7NAkyys2s1vDv+ErZja33d1/BM5P+g+WHknBIVnLzM4gGBtoNsHQIjPN7OTw7kvcfSYwC/iymQ0O24uBhe4+zd2fDW+/6O7TCE5idFknDxdz99nAP/Pu4HJXAnXufjhwLTBzH+Vudfej3P1u4AF3Pzp8zFUEQ0I8D8wHvubu0919LXATwVhVM4F/BX6ZZLknAC938ph3Al939yOBZe3qvo3gjG7TCYbHSOazBOdvmA5MA5aYWTlwM/CpsPY9Q3q/BpzkwQjE1wHfS7K8bwJPhn/DDxAE5J4h7quAkzqpQ3ogbaqSbHZGeHklvN2fIEieIQiLs8P20WH7VoIPyvvbLSNOsHkIYDFweieP9UC7PpXh9InATwHcfbmZvbqPWu9pNz3FzL5DcFrb/gTnWHiPcBjw44H/M7M9zQVJljuC4JwjHecvJTjb4V/DpjvCZZURnM3thbD9LuBjSZa7CLg1HFn2D+6+xMxOBZ5x9zfC57wt7FsK3GFmkwjGhcpLsrwzCEaA3bP/pZDgJEGrCE5zOjLJPNJDKTgkmxnwfXf/zXsagw+4DxGcX3yXmT1N8EEF0NRhH0OLvzsgWxudv+abU+izL43tpm8HznL3pWb2eYKB7TrKAbaH3/j3ZTfBB3eXcvdnwrW3jwK3m9l/A3WddP9P4Cl3P9uCkyU9naSPEayprE5yXyHB85BeQpuqJJstAC4Jv51jZhVmNpTgg7QuDI3JwLFpevznCM6DTXg01NQU5ysB3g6/zV/Qrr0+vA8PTjb0hpmdGy7fzGxakmWtAiZ2bHT3HUDdnn0TBOdB/6u7bwfqzeyYsD3pvgUzGwtsdvebgd8SnMfkReBkMxsX9hkUdi/l3XM7fL6T57wA+CcLV5/MbEa7+w4hGA1YegkFh2QtD06rehfwgpktIzhRUwnwJyBmZquAHxB84KXDL4FyM1sJfIfgXBo7UpjvWoLTlz5HsH9gj7uBr4U7jycQhMql4Y78FQRnB+zoGWDGng/kDi4m2JfwKsE+oOvD9kuBm81sCcE+nmQ1nwosNbNXgPOAn7p7LXA58EBY057Nb/8FfD/s29na2H8SbMJ61cxWhLf3+ADwSCfzSQ+kYdVFOmFmuUCeuzeFH/RPEJw0Kt7NdfwU+KO7P5Fi//4ennLUzK4GRrj7V9JZ4z5qKQD+Cpzo7q2ZqEG6nvZxiHSuH/BUuMnJgCu7OzRC3yM4e2CqPmpm1xC8vzfQ+eal7jAGuFqh0btojUNERCLRPg4REYlEwSEiIpEoOEREJBIFh4iIRKLgEBGRSBQcIiISyf8H3eowKNjI8yEAAAAASUVORK5CYII=\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"1_i4NmnWilF5"},"source":["# Making Predictions¶\n"]},{"cell_type":"code","metadata":{"id":"Kp9d7EzIintX"},"source":["predictor = ktrain.get_predictor(learner.model, preproc)\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZSEz4Z8pg9LC","executionInfo":{"status":"ok","timestamp":1602201177798,"user_tz":-360,"elapsed":2991,"user":{"displayName":"ibrahim al azhar","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhcTQUbimVsO7p7wRuyYZSNKei7erJoiKLzcwQ3eoY=s64","userId":"00085534427974934913"}},"outputId":"54063c5b-ffda-4ee0-c365-933b346dc916","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["predictor.predict(x_test[0:5])\n"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":[""],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"execute_result","data":{"text/plain":["['tarashonkor', 'MZI', 'toslima_nasrin', 'shorotchandra', 'bongkim']"]},"metadata":{"tags":[]},"execution_count":28}]},{"cell_type":"code","metadata":{"id":"yIQ5h3uEjPkj"},"source":["predictor.save('Colab Notebooks/BERTpredictor16author')\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"mTpCFz8Lj5AW"},"source":[""],"execution_count":null,"outputs":[]}]}